<html>

<head>

<title>framework_test</title>

<script type="text/javascript" src="javascript/mootools.js"></script>
<script type="text/javascript">

	/*
	Classes: TILE, WORD, TURN, GAME, BOARD, SPACE, LOBBY, PLAYER, RACK, RACKSPACE, BAG
	
	Example JSON actions:
		{
			"class":"Tile",
			"id":28,
			"action":"move_to"
			"selector":"#rack > .2"
		}

	
	*/

	var echoSocket = new WebSocket("ws://localhost:9292",[]);

	echoSocket.onopen = function(e) {
		// Check the protocol chosen by the server
		console.log("Protocol: " + echoSocket.protocol);
		console.log("readyState: " + echoSocket.readyState);
	};

	echoSocket.onmessage = function(e) {
		var jsonString = e.data;
		console.log("Message:")
		console.log(JSON.stringify(JSON.parse(jsonString), null, 2));
	};

	window.addEvent("domready", function() {
		document.id("submit").addEvent('click', function() {
			echoSocket.send(document.id("input").get('value'));
		});

		document.id("submit_close").addEvent('click', function() {
			echoSocket.close(parseInt(document.id("close_code").value), document.id("close_reason").value);
		});

	});

	window.addEvent("unload", function() {
		console.log("unloading");
		echoSocket.close(1001);
	});

</script>

</head>

<body>
	<h1>Ruby Framework Test</h1>
	<h2>Websocket</h2>
	<h3>Message<h3>
	<input id="input" type="text"></input>
	<input id="submit" type="submit"></input>
	<h3>Close</h3>
	<label for="close_code">Code</label>
	<input id="close_code" type="text"></input>
	<label for="close_reason">Reason</label>
	<input id="close_reason" type="text"></input>
	<input id="submit_close" type="submit"></input>

</body>

</html>
